[["index.html", "Earth Hologenome Initiative | Gaun et al. 2025 The Earth Hologenome Initiative: Data Release 1 1 Introduction 1.1 Accession numbers 1.2 Prepare the R environment", " Earth Hologenome Initiative | Gaun et al. 2025 The Earth Hologenome Initiative: Data Release 1 Nanna Gaun, Raphael Eisenhofer, Carlotta Pietroni, Garazi Martin-Bideguren, Jonas Lauritsen, Ostaizka Aizpurua, Joana Fernandes, Eduardo Ferreira, Fabien Aubret, Tom Sarraude, Constant Perry, Lucas Wauters, Claudia Romeo,, Martina Spada, Claudia Tranquillo, Alex O Sutton, Michael Griesser, Miya Warrington, Guillem Pérez i de Lanuza, Javier Abalos, Prem Aguilar, Ferrán de la Cruz, Javier Juste, Pedro Alonso, Jim Groombridge, Rebecca Louch, Kevin Ruhomaun, Sion Henshaw, Carlos Cabido, Ion Garin Barrio, Emina Šunje, Peter Hosner, Tobias Uller, Nathalie Feiner, Antton Alberdi1 2025-08-01 1 Introduction This webbook contains all the code used for the comparative study on the generation of metagenomic data from faeces of various species using three extraction methods. 1.1 Accession numbers The ENA accession numbers can be found in the sample and raw data metadata tables stored in the Gihub repository: https://github.com/earthhologenome/EHI_data_release_1/tree/main/data 1.2 Prepare the R environment 1.2.1 Environment To reproduce all the analyses locally, clone this repository in your computer using: RStudio &gt; New Project &gt; Version Control &gt; Git And indicating the following git repository: https://github.com/earthhologenome/EHI_data_release_1.git Once the R project has been created, follow the instructions and code chunks shown in this webbook. 1.2.2 Libraries The following R packages are required for the data analysis. # Base library(R.utils) library(tidyverse) library(knitr) library(tidyverse) library(devtools) library(tinytable) library(rairtable) library(phyloseq) library(ggtree) library(ape) library(ggnewscale) library(ggtreeExtra) library(gridExtra) library(ggh4x) library(phytools) University of Copenhagen, antton.alberdi@sund.ku.dk↩︎ "],["metadata-access.html", "2 Metadata access 2.1 Raw dataset metadata 2.2 Sample metadata 2.3 Capture metadata 2.4 Specimen metadata 2.5 Sampling metadata 2.6 Host species metadata 2.7 Assembly metadata 2.8 Genome metadata", " 2 Metadata access Earth Hologenome Initiative metadata are stored in Airtable databases. Contents of those databases can be fetched using the R package raritable. However, data can be directly fetched only with personal access tokens. The relevant fraction of the EHI metadata is published on the EHI website www.earthhologenome.org/database. 2.0.1 Declare release EHI data releases are coded release=&quot;EHR01&quot; 2.1 Raw dataset metadata List EHI dataset names included in the data release. datasets &lt;- airtable(&quot;tblGyiZjOFa0skpV9&quot;, &quot;appQpr6MxnaiVHsHy&quot;) %&gt;% #get base ID from Airtable browser URL read_airtable(., fields = c(&quot;ID&quot;,&quot;Samples_flat&quot;), id_to_col = TRUE) %&gt;% #get 3 columns from MAGs table filter(ID==release) %&gt;% pull(Samples_flat) %&gt;% strsplit(split = &quot;, &quot;) %&gt;% unlist() Fetch dataset preprocessing metadata containing some quantitative metrics of data composition and complexity. rawdata_preprocessing_metadata &lt;- airtable(&quot;tblJfLRU2FIVz37Y1&quot;, &quot;appQpr6MxnaiVHsHy&quot;) %&gt;% read_airtable(., fields = c(&quot;EHI_plaintext&quot;,&quot;C&quot;,&quot;singlem_fraction&quot;), id_to_col = TRUE) %&gt;% select(-airtable_record_id) %&gt;% filter(EHI_plaintext %in% datasets) %&gt;% rename(rawdata_id=EHI_plaintext,microbial_fraction=singlem_fraction,nonpareil_completeness=C) %&gt;% group_by(rawdata_id) %&gt;% summarise(across(where(is.numeric), \\(x) mean(x, na.rm = TRUE))) %&gt;% mutate(microbial_fraction=ifelse(microbial_fraction == 0, NA, microbial_fraction), nonpareil_completeness=ifelse(nonpareil_completeness == 0, NA, nonpareil_completeness)) %&gt;% as_tibble() Fetch dataset metadata and merge with the preprocessing table. rawdata_metadata &lt;- airtable(&quot;tblaMWLkBUn2g5gRR&quot;, &quot;appQpr6MxnaiVHsHy&quot;) %&gt;% read_airtable(., fields = c(&quot;EHI_number&quot;,&quot;sample_alias&quot;,&quot;Total Data (GB)&quot;,&quot;Host Data (GB)&quot;,&quot;Metagenomic Data (GB)&quot;,&quot;ENA_experiment_accession&quot;,&quot;ENA_run_accession&quot;, &quot;sequencing_batch&quot;), id_to_col = TRUE) %&gt;% select(-airtable_record_id) %&gt;% filter(EHI_number %in% datasets) %&gt;% rename(rawdata_id=EHI_number,sample_id=sample_alias,total_gb=`Total Data (GB)`,host_gb=`Host Data (GB)`,metagenomic_gb=`Metagenomic Data (GB)`,accession_experiment=`ENA_experiment_accession`,accession_run=`ENA_run_accession`) %&gt;% mutate(lowqual_gb=total_gb-host_gb-metagenomic_gb) %&gt;% left_join(rawdata_preprocessing_metadata,by=&quot;rawdata_id&quot;) %&gt;% group_by(rawdata_id,sample_id,accession_experiment,accession_run,sequencing_batch) %&gt;% summarise(across(where(is.numeric), \\(x) mean(x, na.rm = TRUE))) %&gt;% as_tibble() # Write to table rawdata_metadata %&gt;% write_tsv(file=str_c(&quot;data/&quot;,release,&quot;_rawdata.tsv&quot;)) 2.2 Sample metadata Fetch metadata of the biological sample from which the DNA sequencing data were derived. sample_metadata &lt;- airtable(&quot;tblW03Z3DcjRdEkoS&quot;, &quot;appQpr6MxnaiVHsHy&quot;) %&gt;% read_airtable(., fields = c(&quot;Code&quot;,&quot;captures_flat&quot;,&quot;Type&quot;,&quot;Origin&quot;,&quot;Freshness&quot;,&quot;Freezing&quot;,&quot;Datasets_flat&quot;,&quot;ENA_sample_accession&quot;), id_to_col = TRUE) %&gt;% select(-airtable_record_id) %&gt;% #only retain samples associated with datasets filter(str_detect(Datasets_flat, paste(datasets, collapse = &quot;|&quot;))) %&gt;% rename(sample_id=Code,capture_id=captures_flat,sample_type=&quot;Type&quot;,sample_origin=&quot;Origin&quot;,freshness=&quot;Freshness&quot;,time_to_freezing=&quot;Freezing&quot;,rawdata_id=&quot;Datasets_flat&quot;,accession=&quot;ENA_sample_accession&quot;) %&gt;% as_tibble() %&gt;% filter(lengths(sample_type) == 1) %&gt;% mutate(sample_type=unlist(sample_type)) # Write to table sample_metadata %&gt;% write_tsv(file=str_c(&quot;data/&quot;,release,&quot;_sample.tsv&quot;)) 2.3 Capture metadata capture_metadata &lt;- airtable(&quot;tbldKeYbUhEYC9NGQ&quot;, &quot;appQpr6MxnaiVHsHy&quot;) %&gt;% read_airtable(., fields = c(&quot;Capture ID code&quot;,&quot;specimen_id&quot;,&quot;sample_id_flat&quot;,&quot;Length (mm)&quot;,&quot;Weight (g)&quot;,&quot;Development&quot;), id_to_col = TRUE) %&gt;% select(-airtable_record_id) %&gt;% #only retain samples associated with samples filter(str_detect(sample_id_flat, paste(sample_metadata$sample_id, collapse = &quot;|&quot;))) %&gt;% rename(capture_id=`Capture ID code`,sample_id=sample_id_flat,animal_length=&quot;Length (mm)&quot;,animal_weight=&quot;Weight (g)&quot;,animal_development=&quot;Development&quot;) %&gt;% as_tibble() # Write to table capture_metadata %&gt;% write_tsv(file=str_c(&quot;data/&quot;,release,&quot;_capture.tsv&quot;)) 2.4 Specimen metadata specimen_metadata &lt;- airtable(&quot;tbl95ZvubrshwRyhD&quot;, &quot;appQpr6MxnaiVHsHy&quot;) %&gt;% read_airtable(., fields = c(&quot;Specimen ID Code&quot;,&quot;captures_flat&quot;,&quot;scientific_name&quot;,&quot;Sex&quot;), id_to_col = TRUE) %&gt;% select(-airtable_record_id) %&gt;% #only retain samples associated with samples filter(str_detect(captures_flat, paste(capture_metadata$capture_id, collapse = &quot;|&quot;))) %&gt;% rename(specimen_id=`Specimen ID Code`,capture_id=captures_flat,host_species=scientific_name,sex=Sex) %&gt;% select(specimen_id,host_species,sex,capture_id) %&gt;% as_tibble() %&gt;% mutate(host_species=unlist(host_species)) # Write to table specimen_metadata %&gt;% write_tsv(file=str_c(&quot;data/&quot;,release,&quot;_specimen.tsv&quot;)) 2.5 Sampling metadata sampling_metadata &lt;- airtable(&quot;tbl48d3HmXsRKwqv1&quot;, &quot;appQpr6MxnaiVHsHy&quot;) %&gt;% read_airtable(., fields = c(&quot;EHI event Code&quot;,&quot;captures_flat&quot;,&quot;Collaborator(s)&quot;,&quot;country_flat&quot;,&quot;Region&quot;,&quot;Place&quot;,&quot;Biome ontology&quot;,&quot;Environmental features&quot;,&quot;Date&quot;,&quot;Latitude reduced&quot;,&quot;Longitude reduced&quot;,&quot;Weather&quot;,&quot;Temperature&quot;), id_to_col = TRUE) %&gt;% select(-airtable_record_id) %&gt;% #only retain samples associated with samples filter(str_detect(captures_flat, paste(capture_metadata$capture_id, collapse = &quot;|&quot;))) %&gt;% rename(sampling_id=`EHI event Code`,capture_id=captures_flat,researcher=`Collaborator(s)`,country=country_flat,region=Region,place=Place,biome=`Biome ontology`,environment=`Environmental features`,date=Date,latitude=`Latitude reduced`,longitude=`Longitude reduced`,weather=Weather,temperature=Temperature) %&gt;% as_tibble() %&gt;% mutate(researcher = map_chr(researcher, ~ paste(.x, collapse = &quot;,&quot;))) %&gt;% mutate(biome=unlist(biome)) # Write to table sampling_metadata %&gt;% write_tsv(file=str_c(&quot;data/&quot;,release,&quot;_sampling.tsv&quot;)) 2.6 Host species metadata host_metadata &lt;- airtable(&quot;tblaRHhZHRPMUjcKJ&quot;, &quot;app6ADWyLxBkDcqYX&quot;) %&gt;% read_airtable(., fields = c(&quot;Name&quot;,&quot;taxid&quot;,&quot;genus_flat&quot;,&quot;family_flat&quot;,&quot;order_flat&quot;,&quot;class_flat&quot;), id_to_col = TRUE) %&gt;% select(-airtable_record_id) %&gt;% #only retain samples associated with samples filter(Name %in% unique(unlist(specimen_metadata$host_species))) %&gt;% rename(host_species=Name,host_genus=genus_flat,host_family=family_flat,host_order=order_flat,host_class=class_flat) %&gt;% as_tibble() # Write to table host_metadata %&gt;% write_tsv(file=str_c(&quot;data/&quot;,release,&quot;_host.tsv&quot;)) 2.7 Assembly metadata Fetch metadata of individual assemblies derived from the raw datasets. Note that co-assemblies encompassing multiple datasets are not included here. assembly_metadata &lt;- airtable(&quot;tblG6ZIvkYN844I97&quot;, &quot;appQpr6MxnaiVHsHy&quot;) %&gt;% read_airtable(., fields = c(&quot;ID&quot;,&quot;EHI_number_api&quot;,&quot;Type (from AB Batch)&quot;,&quot;N50&quot;,&quot;L50&quot;,&quot;num_contigs&quot;,&quot;num_bins&quot;,&quot;release_flat&quot;), id_to_col = TRUE) %&gt;% select(-airtable_record_id) %&gt;% filter(release_flat == release) %&gt;% rename(assembly_id=ID,rawdata_id=EHI_number_api,assembly_type=`Type (from AB Batch)`,assembly_n50=N50,assembly_l50=L50,assembly_contigs=num_contigs) %&gt;% #only retain individual assemblies filter(assembly_type == &quot;Individual&quot;) %&gt;% #only retain successful assemblies filter(assembly_contigs&gt;0) %&gt;% select(assembly_id,rawdata_id,assembly_n50,assembly_l50,assembly_contigs,num_bins) %&gt;% as_tibble() # Write to table assembly_metadata %&gt;% write_tsv(file=str_c(&quot;data/&quot;,release,&quot;_assembly.tsv&quot;)) 2.8 Genome metadata Fetch metadata of metagenome-assembled genomes (MAGs) derived from individual assemblies. genome_metadata &lt;- airtable(&quot;tblMzd3oyaJhdeQcs&quot;, &quot;appWbHBNLE6iAsMRV&quot;, view=release) %&gt;% read_airtable(., fields = c(&quot;ID&quot;,&quot;eha_number&quot;,&quot;GTDB_version&quot;,&quot;domain&quot;,&quot;phylum&quot;,&quot;class&quot;,&quot;order&quot;,&quot;family&quot;,&quot;genus&quot;,&quot;species&quot;,&quot;completeness&quot;,&quot;contamination&quot;,&quot;size&quot;,&quot;GC&quot;,&quot;N50&quot;,&quot;coding_density&quot;,&quot;contigs&quot;,&quot;Release&quot;), id_to_col = TRUE) %&gt;% select(-airtable_record_id) %&gt;% rename(genome_id=ID,assembly_id=eha_number,genome_size=size,genome_gc=GC,genome_n50=N50) %&gt;% as_tibble() # Write to table genome_metadata %&gt;% write_tsv(file=str_c(&quot;data/&quot;,release,&quot;_genome.tsv&quot;)) "],["data-statistics.html", "3 Data statistics 3.1 Amount of data 3.2 Amount of samples 3.3 Sample type statistics 3.4 Country statistics 3.5 Environmental representation", " 3 Data statistics rawdata_metadata &lt;- read_tsv(file=str_c(&quot;data/&quot;,release,&quot;_rawdata.tsv&quot;)) #assembly_metadata &lt;- read_tsv(file=str_c(&quot;data/&quot;,release,&quot;_assembly.tsv&quot;)) #genome_metadata &lt;- read_tsv(file=str_c(&quot;data/&quot;,release,&quot;_genome.tsv&quot;)) sample_metadata &lt;- read_tsv(file=str_c(&quot;data/&quot;,release,&quot;_sample.tsv&quot;)) capture_metadata &lt;- read_tsv(file=str_c(&quot;data/&quot;,release,&quot;_capture.tsv&quot;)) specimen_metadata &lt;- read_tsv(file=str_c(&quot;data/&quot;,release,&quot;_specimen.tsv&quot;)) sampling_metadata &lt;- read_tsv(file=str_c(&quot;data/&quot;,release,&quot;_sampling.tsv&quot;)) host_metadata &lt;- read_tsv(file=str_c(&quot;data/&quot;,release,&quot;_host.tsv&quot;)) 3.1 Amount of data 3.1.1 Absolute total data rawdata_metadata %&gt;% summarise(total=sum(total_gb),host=sum(host_gb),metagenomic=sum(metagenomic_gb),lowqual=sum(lowqual_gb)) %&gt;% tt() .table td.tinytable_css_id9c1xxnyxq3ayxxnfsnhb, .table th.tinytable_css_id9c1xxnyxq3ayxxnfsnhb { border-bottom: solid 0.1em #d3d8dc; } total host metagenomic lowqual 5217.28 994.6583 3882.8 339.8216 3.1.2 Relative total data rawdata_metadata %&gt;% summarise(total=sum(total_gb),host=sum(host_gb),metagenomic=sum(metagenomic_gb),lowqual=sum(lowqual_gb)) %&gt;% mutate(host=host/total*100,metagenomic=metagenomic/total*100,lowqual=lowqual/total*100) %&gt;% mutate(total=total/total*100) %&gt;% tt() .table td.tinytable_css_id9mpvp7xgakz0d4bjyq2o, .table th.tinytable_css_id9mpvp7xgakz0d4bjyq2o { border-bottom: solid 0.1em #d3d8dc; } total host metagenomic lowqual 100 19.06469 74.42192 6.513386 3.1.3 Per-sample data rawdata_metadata %&gt;% summarise(total=mean(total_gb),sd(total_gb),host=mean(host_gb),metagenomic=mean(metagenomic_gb),lowqual=mean(lowqual_gb)) %&gt;% tt() .table td.tinytable_css_idze1itdorn7y97a6eb4yz, .table th.tinytable_css_idze1itdorn7y97a6eb4yz { border-bottom: solid 0.1em #d3d8dc; } total sd(total_gb) host metagenomic lowqual 5.389752 3.838031 1.02754 4.011157 0.3510553 3.1.4 Per-sample relative data rawdata_metadata %&gt;% mutate(host_rel=host_gb/total_gb*100, metagenomic_rel=metagenomic_gb/total_gb*100, lowqual_rel=lowqual_gb/total_gb*100) %&gt;% filter(host_rel&gt;=0 &amp; metagenomic_rel&gt;=0, lowqual_rel&gt;=0) %&gt;% summarise(host_mean=mean(host_rel), host_sd=sd(host_rel), metagenomic_mean=mean(metagenomic_rel), metagenomic_sd=sd(metagenomic_rel), lowqual_mean=mean(lowqual_rel), lowqual_sd=sd(lowqual_rel)) %&gt;% tt() .table td.tinytable_css_id785oc90yzsdoaacbyvrf, .table th.tinytable_css_id785oc90yzsdoaacbyvrf { border-bottom: solid 0.1em #d3d8dc; } host_mean host_sd metagenomic_mean metagenomic_sd lowqual_mean lowqual_sd 16.5684 27.51604 76.54316 28.73969 6.888443 7.141278 3.2 Amount of samples summary_table &lt;- sampling_metadata %&gt;% separate_rows(capture_id, sep = &quot;, &quot;) %&gt;% right_join(capture_metadata,by=&quot;capture_id&quot;) %&gt;% select(-capture_id) %&gt;% right_join(specimen_metadata,by=&quot;specimen_id&quot;) %&gt;% inner_join(host_metadata,by=&quot;host_species&quot;) %&gt;% select(-capture_id) %&gt;% separate_rows(sample_id, sep = &quot;, &quot;) %&gt;% right_join(sample_metadata,by=&quot;sample_id&quot;) %&gt;% select(-rawdata_id) %&gt;% right_join(rawdata_metadata,by=&quot;sample_id&quot;) %&gt;% separate_rows(rawdata_id, sep = &quot;, &quot;) %&gt;% filter(rawdata_id %in% datasets) summary_table %&gt;% group_by(host_species,host_order,host_class) %&gt;% summarise(events=n_distinct(sampling_id),individuals=n_distinct(specimen_id),samples=n_distinct(sample_id),data=sum(total_gb)) %&gt;% tt() .table td.tinytable_css_idtti5nfk4ya3n3o3hh7ws, .table th.tinytable_css_idtti5nfk4ya3n3o3hh7ws { border-bottom: solid 0.1em #d3d8dc; } host_species host_order host_class events individuals samples data Calotriton asper Caudata Amphibia 5 31 37 230.3935473 Canis familiaris Carnivora Mammalia 14 58 58 333.7068270 Chalcides striatus Squamata Lepidosauria 2 2 2 39.4685949 Geospizopsis unicolor Passeriformes Aves 1 2 2 27.1929588 Lepus europaeus Lagomorpha Mammalia 15 25 50 252.6467382 Lissotriton helveticus Caudata Amphibia 16 88 97 444.6582528 Natrix astreptophora Squamata Lepidosauria 2 2 2 32.8438776 Perisoreus infaustus Passeriformes Aves 3 3 3 38.4660147 Plecotus auritus Chiroptera Mammalia 1 2 2 42.1295469 Podarcis filfolensis Squamata Lepidosauria 9 43 43 174.6792330 Podarcis gaigeae Squamata Lepidosauria 17 61 61 303.4715766 Podarcis liolepis Squamata Lepidosauria 2 13 13 66.9840543 Podarcis milensis Squamata Lepidosauria 8 26 26 149.6805216 Podarcis muralis Squamata Lepidosauria 35 154 165 998.4877083 Podarcis pityusensis Squamata Lepidosauria 12 43 43 220.7678289 Psittacula echo Psittaciformes Aves 49 48 50 591.2283414 Salamandra atra Caudata Amphibia 1 2 2 23.8163316 Sciurus carolinensis Rodentia Mammalia 47 65 120 533.1140394 Sciurus vulgaris Rodentia Mammalia 76 74 123 660.4551216 Strix aluco Strigiformes Aves 1 1 1 3.7065531 Trichosurus vulpecula Diprotodontia Mammalia 2 2 2 20.8527879 Zonotrichia capensis Passeriformes Aves 1 2 2 27.9869136 NA NA NA 1 1 1 0.5422788 3.3 Sample type statistics summary_table %&gt;% mutate(sample_type=ifelse(sample_type==&quot;Skin swab: dorsal&quot;,&quot;Skin swab&quot;,sample_type), sample_type=ifelse(sample_type==&quot;Skin swab: ventral&quot;,&quot;Skin swab&quot;,sample_type)) %&gt;% group_by(sample_type) %&gt;% summarise(samples=n()) %&gt;% tt() .table td.tinytable_css_id9heyfr825hy11qjch02i, .table th.tinytable_css_id9heyfr825hy11qjch02i { border-bottom: solid 0.1em #d3d8dc; } sample_type samples Anal/cloacal swab 23 Colon contents 26 Faecal 894 Oral swab 13 Skin swab 6 Tissue 5 NA 1 3.4 Country statistics sampling_metadata %&gt;% pull(country) %&gt;% unique() %&gt;% length() [1] 12 summary_table %&gt;% group_by(country) %&gt;% summarise(samples=n()) %&gt;% tt() .table td.tinytable_css_id7cdj8j1u1edz0b4ir06n, .table th.tinytable_css_id7cdj8j1u1edz0b4ir06n { border-bottom: solid 0.1em #d3d8dc; } country samples Australia 6 Bosnia and Herzegovina 6 Ecuador 12 France 60 Greece 87 Greenland 58 Italy 271 Malta 43 Mauritius 61 Portugal 12 Spain 344 Sweden 7 NA 1 3.5 Environmental representation sampling_metadata %&gt;% group_by(biome) %&gt;% summarise(count = n()) %&gt;% arrange(-count) %&gt;% tt() .table td.tinytable_css_idjzprxeis7qpo36x5vkbi, .table th.tinytable_css_idjzprxeis7qpo36x5vkbi { border-bottom: solid 0.1em #d3d8dc; } biome count 1000221 - Temperate woodland 143 1000220 - Tropical woodland 31 1000215 - Temperate shrubland 29 1001803 - Tropical forest 18 1000252 - Lake or pond 16 1001625 - Polar Tundra 15 1000218 - Xeric shrubland 14 1000248 - Dense settlement 10 1000194 - Montane grassland 8 1000246 - Village 6 1000253 - River or stream 5 1000196 - Coniferous forest 4 1000199 - Mediterranean forest 4 1000216 - Montane shrubland 4 1000198 - Mixed forest 3 1000250 - Boreal forests or taiga 3 1000247 - Rangeland 2 1000197 - Broadleaf forest 1 1000245 - Cropland 1 1001505 - Alpine tundra 1 "],["host-tree.html", "4 Host tree", " 4 Host tree Fetch all host species logged in the EHI database and output them into a texfile. airtable(&quot;tbl95ZvubrshwRyhD&quot;, &quot;appQpr6MxnaiVHsHy&quot;) %&gt;% read_airtable(., fields = &quot;scientific_name&quot;, id_to_col = TRUE) %&gt;% select(-airtable_record_id) %&gt;% pull(scientific_name) %&gt;% unlist() %&gt;% unique() %&gt;% write.table(.,file=str_c(&quot;data/&quot;,release,&quot;_allhosts.txt&quot;),row.names=FALSE,col.names=FALSE,quote=FALSE) Pull taxonomic metadata of all hosts. airtable(&quot;tbl95ZvubrshwRyhD&quot;, &quot;appQpr6MxnaiVHsHy&quot;) %&gt;% read_airtable(., fields = c(&quot;scientific_name&quot;,&quot;Family&quot;,&quot;Order&quot;,&quot;Class&quot;), id_to_col = TRUE) %&gt;% select(-airtable_record_id) %&gt;% unlist() %&gt;% write.table(.,file=str_c(&quot;data/&quot;,release,&quot;_allhosts.tsv&quot;),row.names=FALSE,col.names=FALSE,quote=FALSE) Generate a time-calibrated host tree in https://timetree.org and load it. all_host_tree &lt;- read_tree(str_c(&quot;data/&quot;,release,&quot;_allhosts.nwk&quot;)) ggtree(all_host_tree) "],["bacterial-genome-statistics.html", "5 Bacterial genome statistics 5.1 Genome quantity 5.2 Genome quality 5.3 Taxonomic statistics 5.4 New taxa discovery 5.5 Microbial phylogenies", " 5 Bacterial genome statistics genome_metadata &lt;- read_tsv(file=str_c(&quot;data/&quot;,release,&quot;_genome.tsv&quot;)) assembly_metadata &lt;- read_tsv(file=str_c(&quot;data/&quot;,release,&quot;_assembly.tsv&quot;)) host_metadata &lt;- read_tsv(file=str_c(&quot;data/&quot;,release,&quot;_host.tsv&quot;)) phylum_colors &lt;- read_tsv(&quot;https://raw.githubusercontent.com/earthhologenome/EHI_taxonomy_colour/main/ehi_phylum_colors.tsv&quot;) %&gt;% right_join(genome_metadata, by=join_by(phylum == phylum)) %&gt;% select(phylum, colors) %&gt;% unique() %&gt;% arrange(phylum) %&gt;% pull(colors, name=phylum) 5.1 Genome quantity genome_metadata %&gt;% nrow() [1] 17666 5.2 Genome quality genome_metadata %&gt;% summarise(completenes_mean=mean(completeness), completenes_sd=sd(completeness), contamination_mean=mean(contamination), contamination_sd=sd(contamination)) %&gt;% tt() .table td.tinytable_css_iddie82wh25v41clhaqkqw, .table th.tinytable_css_iddie82wh25v41clhaqkqw { border-bottom: solid 0.1em #d3d8dc; } completenes_mean completenes_sd contamination_mean contamination_sd 83.44642 15.27152 1.842268 2.068018 #Generate quality biplot genome_biplot &lt;- genome_metadata %&gt;% select(c(genome_id,domain,phylum,completeness,contamination,genome_size)) %&gt;% ggplot(aes(x=completeness,y=contamination,color=phylum)) + geom_point(alpha=0.7, size=1) + ylim(c(10,0)) + scale_color_manual(values=phylum_colors) + labs(y= &quot;Contamination&quot;, x = &quot;Completeness&quot;) + theme_classic() + theme(legend.position = &quot;none&quot;) #Generate contamination boxplot genome_contamination &lt;- genome_metadata %&gt;% ggplot(aes(y=contamination)) + ylim(c(10,0)) + geom_boxplot(colour = &quot;#999999&quot;, fill=&quot;#cccccc&quot;) + theme_void() + theme(legend.position = &quot;none&quot;, axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank(), plot.margin = unit(c(0, 0, 0.40, 0),&quot;inches&quot;)) #add bottom-margin (top, right, bottom, left) #Generate completeness boxplot genome_completeness &lt;- genome_metadata %&gt;% ggplot(aes(x=completeness)) + xlim(c(50,100)) + geom_boxplot(colour = &quot;#999999&quot;, fill=&quot;#cccccc&quot;) + theme_void() + theme(legend.position = &quot;none&quot;, axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank(), plot.margin = unit(c(0, 0, 0, 0.50),&quot;inches&quot;)) #add left-margin (top, right, bottom, left) #Render composite figure grid.arrange(grobs = list(genome_completeness,genome_biplot,genome_contamination), layout_matrix = rbind(c(1,1,1,1,1,1,1,1,1,1,1,4), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3))) 5.3 Taxonomic statistics #phylum genome_metadata %&gt;% group_by(phylum) %&gt;% summarise(genomes=n(), completenes=mean(completeness), contamination=mean(contamination), size=mean(genome_size)/1000000) %&gt;% arrange(-genomes) %&gt;% filter(phylum != &quot;p__&quot;) %&gt;% tt() .table td.tinytable_css_id6qec5dwyor0zgy1dfu35, .table th.tinytable_css_id6qec5dwyor0zgy1dfu35 { border-bottom: solid 0.1em #d3d8dc; } phylum genomes completenes contamination size p__Bacillota_A 7660 83.63684 1.8564150 2.6698451 p__Bacteroidota 5466 82.44019 1.9224195 3.1037856 p__Bacillota 1196 84.93360 2.0009691 1.9905318 p__Pseudomonadota 1084 83.65532 1.7633404 2.2769868 p__Desulfobacterota 426 82.63150 1.3259789 2.7608495 p__Verrucomicrobiota 368 89.20122 0.8901549 2.4563478 p__Bacillota_C 286 86.76010 1.3554091 2.1364236 p__Fusobacteriota 277 78.98047 3.0329856 1.8140626 p__Campylobacterota 231 92.77437 0.5623247 1.6291809 p__Cyanobacteriota 188 83.70330 1.8254309 1.7655936 p__Actinomycetota 121 76.29562 2.4501157 2.0137161 p__Bacillota_B 89 79.90292 1.3200337 2.3982632 p__Spirochaetota 50 89.42120 0.8281800 1.9738926 p__Deferribacterota 48 88.51146 1.0714167 2.0691184 p__Halobacteriota 35 79.48543 0.8428286 1.5453826 nan 27 57.23556 6.5140741 2.3480021 p__Elusimicrobiota 26 84.47308 0.8029231 1.4538194 p__Patescibacteria 23 79.55087 2.4182609 0.7524267 p__Synergistota 23 85.02000 1.5530435 1.9802283 p__Thermoplasmatota 7 79.61571 1.7065714 1.3443116 p__Chlamydiota 6 93.69667 0.4398333 1.1624107 p__Acidobacteriota 5 77.44000 2.1200000 3.9690980 p__Chloroflexota 4 67.88500 1.7650000 2.7801572 p__Methanobacteriota 4 95.24250 0.0950000 1.7985060 p__Desulfobacterota_F 3 70.69667 5.8733333 3.8540867 p__Myxococcota 3 75.54333 3.4300000 6.9908893 p__Planctomycetota 3 88.50000 2.2966667 5.7144443 p__Bdellovibrionota 1 96.59000 1.3200000 2.4054180 p__Desulfobacterota_G 1 81.00000 5.4100000 2.3275200 p__Fibrobacterota 1 76.19000 2.0900000 5.6243300 p__J088 1 58.55000 7.3500000 2.1950540 p__JAKLEM01 1 50.37000 2.7500000 1.5253600 p__Nanoarchaeota 1 90.32000 0.2600000 1.1657700 selected_phyla &lt;- genome_metadata %&gt;% group_by(phylum) %&gt;% summarise(genomes=n(), completenes=mean(completeness), contamination=mean(contamination), size=mean(genome_size)/1000000) %&gt;% arrange(-genomes) %&gt;% filter(genomes &gt; 0) %&gt;% filter(phylum != &quot;p__&quot;) %&gt;% filter(phylum != &quot;nan&quot;) %&gt;% pull(phylum) #genus genome_metadata %&gt;% group_by(genus) %&gt;% summarise(genomes=n(), completenes=mean(completeness), contamination=mean(contamination), size=mean(genome_size)/1000000) %&gt;% arrange(-genomes) %&gt;% filter(genus != &quot;g__&quot;) %&gt;% tt() .table td.tinytable_css_id107pzr9qjc6xku601lom, .table th.tinytable_css_id107pzr9qjc6xku601lom { border-bottom: solid 0.1em #d3d8dc; } genus genomes completenes contamination size g__Bacteroides 995 77.92362 2.6961698 3.9651835 g__Parabacteroides 666 83.40375 1.9451096 4.0941772 g__Odoribacter 492 83.59722 1.7916179 3.2274854 g__Phocaeicola 473 80.95539 2.5157125 3.6959090 g__Mucinivorans 394 85.47764 1.2383249 1.9797230 g__Alistipes 381 83.13457 2.5315486 2.3172480 g__Acetatifactor 286 84.53587 2.1086923 3.1476202 g__Prevotella 217 82.68829 1.5985622 2.8212732 g__CAG-95 207 87.55551 1.7903961 3.5408488 g__Eisenbergiella 207 85.28589 2.1851546 3.0893296 g__Akkermansia 204 91.36064 0.7044118 2.5966057 g__JAAYNV01 199 90.64643 1.1541608 3.5621598 g__Roseburia 179 92.47715 2.0254246 3.6390563 g__Alloprevotella 139 84.18741 1.3816043 2.3153503 g__Sutterella 134 78.09709 2.5147090 1.8383372 g__Helicobacter_J 133 94.63789 0.5138045 1.6555468 g__Bilophila 131 82.97084 1.2026870 2.9439524 g__Parabacteroides_B 128 86.13469 1.3689297 3.6360034 g__JADFUS01 127 83.16150 1.8150394 1.9485266 g__Faecalibacterium 124 89.36734 1.4272016 2.3737659 g__Fusobacterium_B 123 77.71016 3.3592683 1.4970338 g__CAG-485 121 82.14438 1.7928678 2.6651206 g__Ventrimonas 120 84.84408 1.8006750 3.2637433 g__Dielma 114 85.20140 2.8130088 2.9422261 g__UBA866 112 85.66286 0.6738304 2.2231868 g__Anaerobiospirillum 110 77.97973 1.6881818 2.8765630 g__Kineothrix 107 91.37673 1.3691963 3.5804729 g__Faecousia 104 82.80192 2.6728365 2.3654319 g__Fusobacterium_A 99 79.58040 2.7303737 2.1963039 g__Hungatella_A 99 80.35202 1.8181414 3.4278902 g__Negativibacillus 94 81.51989 1.3455957 2.7047978 g__Rikenella 92 82.78370 1.4818370 2.3321788 g__Anaerotruncus 91 77.46143 2.1054725 2.8081749 g__Coproplasma 90 87.41667 1.4002444 1.7880074 g__Mycoplasmoides 88 93.71159 1.0866136 0.9189457 g__Clostridium_Q 87 82.55977 1.9982184 3.3526316 g__Phascolarctobacterium_A 87 92.73759 1.0611494 1.9130573 g__Enterocloster 85 73.65765 2.4283059 3.4805288 g__CAG-873 84 82.26417 1.4332024 2.2541093 g__MGBC136627 84 88.45881 1.7716905 3.5600748 g__Velocimicrobium 84 82.19952 1.7921190 3.4970167 g__Breznakia 81 83.92790 2.6760000 2.3905107 g__Desulfovibrio 81 82.64000 0.9717778 2.6713025 g__Duncaniella 73 86.44288 1.5759452 2.8084462 g__Mediterranea 73 73.23233 2.0328219 2.5431099 g__Blautia 71 77.97296 2.1251408 2.3964722 g__Gallimonas 70 80.49971 1.7425857 1.5319185 g__UBA3282 67 83.18657 2.4837313 2.8917401 g__Blautia_A 66 78.29333 2.5475303 2.6331948 g__Clostridium 65 77.62754 3.8155077 2.8154605 g__Paraprevotella 63 81.63063 1.6602222 2.6681593 g__Butyribacter 61 85.77377 1.5609180 2.6091618 g__Fimenecus 61 91.23672 0.8020164 2.0493588 g__Mycoplasma_L 60 82.92950 1.2753333 0.8161472 g__UBA7173 60 83.94050 1.3481167 2.3296797 g__Lachnotalea 59 88.30949 1.4985932 3.4470263 g__RGIG4733 53 88.20226 1.5693585 3.7266071 g__Sarcina 53 81.09679 3.4446415 2.7101501 g__COE1 52 83.91038 1.4435769 2.8021602 g__Choladocola 52 84.95115 2.5897692 2.9373829 g__UBA4293 52 89.61173 0.8290192 3.2235269 g__Oscillibacter 51 81.01118 1.8590196 2.4733692 g__Aeromonas 50 82.40220 3.0419600 3.5107695 g__CAG-590 50 84.31020 2.2098600 2.9334324 g__Tidjanibacter 50 85.65200 1.2493200 1.8963239 g__Egerieousia 48 85.59458 0.5516667 2.2010446 g__Thomasclavelia 46 84.88217 2.7868696 3.0107252 g__JAGBWK01 45 89.04178 0.8749556 2.3016604 g__Lacrimispora 45 83.79956 1.6396889 3.6979302 g__Ruthenibacterium 45 83.53022 1.3971556 2.3653774 g__Dysosmobacter 44 76.11500 4.0797955 2.1224684 g__Coprobacillus 43 82.81093 1.6351860 3.0103715 g__Phascolarctobacterium 43 87.04116 1.4251860 1.8940801 g__Anaeroplasma 42 92.64095 0.8646190 1.8052963 g__CAG-269 42 75.28857 3.2166905 1.4452935 g__NHYM01 42 91.68500 0.5695952 1.4654067 g__Ventricola 42 78.79071 2.2226905 2.3753320 g__Angelakisella 41 82.76976 1.7889512 2.1072189 g__CAZU01 41 79.86268 1.7481220 1.3659968 g__Gemmiger 41 83.81610 1.3887073 2.3286345 g__MGBC140009 41 84.33976 2.4121707 3.7236640 g__Mailhella 41 78.82341 2.2531220 2.5250809 g__Agathobacter 40 90.09900 1.6338750 2.5229392 g__Intestinimonas 39 68.40231 3.4260256 2.3852665 g__JALFVM01 38 81.90132 2.5451316 3.4917372 g__Spyradosoma 38 92.30158 0.9870263 2.0382154 g__Escherichia 36 84.67444 1.7038333 3.9970872 g__Schaedlerella 36 78.73861 2.1680556 2.0911660 g__Eubacterium_R 35 84.04600 1.3162571 1.8685195 g__Onthomonas 35 74.46029 3.1912286 1.9405050 g__RUG626 35 83.82000 2.5092286 2.1093002 g__UMGS1251 35 84.39257 1.9006571 3.4825123 g__C-19 34 83.51353 2.3952941 3.2058556 g__14-2 33 86.72121 2.1555455 3.3366215 g__Copromonas 33 75.81970 1.9798788 2.8615975 g__Eubacterium_F 32 85.66844 1.5546250 2.3202193 g__Hespellia 32 89.54844 1.3649062 3.0104425 g__MGBC165282 32 85.64906 1.4530625 3.6739215 g__Hungatella 31 69.71710 3.1118710 3.7416695 g__CHH4-2 30 78.02567 2.5256333 3.5036532 g__Choladousia 30 78.26333 2.9143667 2.9013940 g__Cryptobacteroides 30 89.91333 0.8906333 2.2596847 g__Peptacetobacter 30 66.79600 6.0543333 1.2924748 g__Anaerotignum 29 75.88310 0.8496897 1.8767279 g__Avoscillospira 29 76.29897 2.8831379 2.0856524 g__Buttiauxella 29 91.07897 2.4246552 4.3789606 g__Coprococcus 29 89.06379 1.8997241 2.3107429 g__Fournierella 28 73.14214 1.6625357 2.0496987 g__OM05-12 28 78.94000 1.5729643 2.6386065 g__SZUA-378 28 86.15786 1.7120000 3.5049438 g__UBA4292 28 85.90536 1.8812500 2.5996167 g__CAJOIG01 27 79.05778 2.7751852 1.9185877 g__CALUXS01 27 94.06667 0.9570370 1.5374482 g__Cetobacterium 27 82.90741 2.5951852 1.7825497 g__Collinsella 27 71.78222 3.8548148 1.2819601 g__Helicobacter_C 27 88.67704 0.6895556 1.7210363 g__Hydrogenoanaerobacterium 27 82.34519 1.5512963 2.5825329 g__Limiplasma 27 83.68333 1.8910741 2.8382916 nan 27 57.23556 6.5140741 2.3480021 g__Aphodousia 26 80.16154 2.8038462 1.4720213 g__UBA3402 26 78.36077 1.8734615 2.5038624 g__Brevinema 25 87.34560 0.3862400 1.5371430 g__Caccovivens 25 85.03240 1.1198400 1.0389124 g__Limenecus 25 82.54560 1.8186800 1.8672024 g__UBA3263 25 82.30520 0.6958000 1.7601897 g__Faecalimonas 24 73.32208 3.3441667 1.8824803 g__Lachnospira 24 82.40208 1.5590000 2.2169013 g__Methanimicrococcus 24 80.83625 0.3851250 1.5520424 g__RGIG6463 24 80.44458 0.7970833 2.2916688 g__CAJLXD01 23 86.96739 1.6352609 1.6444605 g__Lawsonibacter 23 75.29783 2.8700870 2.1052055 g__Allobaculum 22 77.57500 1.4900000 1.6896365 g__Paramuribaculum 22 81.68864 1.4965000 2.2101198 g__RGIG8745 22 86.95364 1.7870455 3.4315803 g__Gabonibacter 21 77.22000 1.8800000 1.6124958 g__JAAYQI01 21 69.06238 1.7699524 2.1624466 g__JAIHAL01 21 87.04952 1.0899048 2.3932120 g__Malacoplasma 21 89.14095 0.1295238 0.8337645 g__Ruminococcus_D 21 86.38381 1.7647619 2.4706773 g__Scatousia 21 81.40905 1.7330952 1.7581827 g__Fimivivens 20 72.59150 1.8892500 1.9109774 g__UBA7185 20 78.11850 2.3116000 3.1003050 g__Wujia 20 92.27650 0.7544500 2.4663226 g__Anaerorhabdus 19 86.22842 2.3089474 2.0410849 g__CAJGBR01 19 93.55211 0.5894737 2.0523218 g__Enterenecus 19 79.08211 2.6178947 2.8217814 g__Enterobacter 19 84.27526 2.7117368 4.0659331 g__Megamonas 19 87.17316 0.8210526 1.8561629 g__RGIG7193 19 84.78053 2.0663684 3.0439785 g__V9D3004 19 90.52211 0.4336842 2.1702400 g__HGM05232 18 79.35722 0.6916667 2.4383337 g__Intestinibacillus 18 81.18167 1.8997222 2.2748363 g__Lawsonia 18 87.17833 0.1688889 1.6480921 g__Ligilactobacillus 18 90.62889 1.3157778 1.9454732 g__Limivicinus 18 78.65056 1.9838333 2.0402612 g__Pseudoflavonifractor 18 72.78000 3.4371667 2.7094166 g__Victivallis 18 82.95556 2.2455556 2.0432232 g__CAG-475 17 91.07412 0.7778235 1.6333128 g__Hafnia 17 97.47588 1.2116471 4.5378244 g__JAJQCX01 17 91.35471 1.0760000 2.0961163 g__Mobilisporobacter 17 79.21588 0.9817647 3.3577416 g__Pelethenecus 17 92.13941 1.6034118 1.6939882 g__RGIG3002 17 85.13353 1.6290588 2.9891660 g__UMGS1601 17 87.35059 1.6084118 1.5898784 g__Butyricicoccus 16 77.95875 2.1223125 1.8295139 g__CAG-303 16 78.19250 0.9305000 2.2399191 g__JAGNZR01 16 80.90625 2.4668750 1.9934354 g__MGBC124762 16 85.49250 1.6968750 1.6778561 g__MGBC143606 16 83.89437 1.3517500 2.5475539 g__Mucispirillum 16 92.66813 0.9275000 2.1710365 g__NSJ-61 16 78.92875 2.8026875 3.1963778 g__RGIG4057 16 83.30813 2.7732500 2.8164863 g__Scatovivens 16 79.97000 3.9351250 1.6014924 g__UBA1436 16 79.45125 0.9028750 1.3896149 g__Butyricimonas 15 77.71800 2.0480667 3.5712587 g__CAG-115 15 89.73133 1.4478667 2.3633040 g__CAG-345 15 87.78867 0.6980000 1.1255293 g__Coprovivens 15 89.14867 3.1561333 1.6626844 g__Faecalibacillus 15 81.48933 2.9618667 2.0282674 g__Gallibacteroides 15 87.19267 1.6619333 3.3566440 g__Limisoma 15 91.87533 0.7500000 2.2638763 g__MGBC131033 15 78.97667 0.8014000 3.0528997 g__Ruminococcus_B 15 82.27133 2.2840000 2.2162278 g__Ruminococcus_E 15 90.06133 1.2131333 1.8719297 g__UBA1366 15 93.60667 0.1346667 2.4917192 g__UBA3210 15 91.76867 1.1938667 1.6110601 g__Vibrio 15 88.26533 1.6884667 3.3766213 g__WRDF01 15 77.63600 1.4408667 1.9448615 g__Avidehalobacter 14 82.33429 1.1295714 1.3045046 g__CAG-41 14 80.61571 1.6999286 2.0891159 g__CAG-882 14 89.67571 1.7981429 2.5456252 g__Corynebacterium 14 86.91357 1.0013571 2.6261024 g__Gallispira 14 78.86929 1.0910714 1.7625166 g__JAGAJR01 14 88.44357 1.3408571 1.5218473 g__MGBC120314 14 82.54643 1.9436429 2.4528977 g__Marvinbryantia 14 79.14786 2.2400000 2.4492391 g__Phocaeicola_A 14 77.01286 2.1014286 2.8914770 g__Scatenecus 14 89.59929 0.9616429 1.7149177 g__Scatocola 14 90.82500 1.1031429 1.6045308 g__Agathobaculum 13 82.49923 1.7402308 1.9285279 g__Anaerovorax 13 75.08154 2.7652308 2.4056592 g__CAG-353 13 82.15692 0.8066923 2.1141138 g__CALURL01 13 78.61077 1.6466923 1.8524853 g__CALXXL01 13 79.39077 1.0584615 1.6901949 g__JAMPGF01 13 79.40692 1.5488462 1.9077198 g__Monoglobus 13 75.65231 1.6027692 1.9851695 g__Plesiomonas 13 95.07385 1.0910000 3.0547004 g__Pyramidobacter 13 82.76154 1.6353846 1.8359814 g__RUG115 13 94.56077 1.5005385 2.8348890 g__Ruminiclostridium_E 13 93.66692 1.5801538 2.4047092 g__Ruminococcus 13 80.74385 1.7870000 2.1840112 g__Scatacola_A 13 94.66846 1.4323077 1.7322834 g__Spyradomonas 13 85.03077 2.5104615 1.8633028 g__Turicibacter 13 84.60615 2.9030769 2.4365091 g__CAG-632 12 87.22250 1.1827500 2.6463514 g__CALWRD01 12 79.36583 0.9625000 1.8398565 g__HGM11604 12 85.50417 2.3524167 2.2094266 g__HGM12587 12 79.23417 2.4854167 2.4348218 g__Muribaculum 12 95.85500 0.9915833 2.8024387 g__RUG762 12 82.31167 0.8645000 2.3704922 g__Sphingobacterium 12 87.79500 2.2208333 3.4751798 g__Acinetobacter 11 88.44364 2.1445455 2.9133812 g__Amedibacillus 11 77.81000 3.1126364 2.3726295 g__Avimicrobium 11 78.56273 2.5654545 1.4474214 g__CAG-45 11 87.07273 2.5760909 2.6139032 g__CAG-826 11 84.24091 0.6108182 1.1712523 g__Emergencia 11 82.04273 2.2111818 2.3547694 g__Merdiplasma 11 84.75455 1.5754545 2.5006045 g__RGIG8482 11 79.63000 1.6793636 1.5086870 g__RUG11237 11 85.71545 2.8322727 3.1361335 g__UBA3855 11 86.04364 0.9218182 2.0427817 g__UMGS27 11 88.78182 0.6066364 2.8674768 g__Avirikenella 10 81.25900 0.6810000 1.9417783 g__Butyricicoccus_A 10 87.19400 1.2097000 2.0787766 g__CAG-103 10 84.10800 2.6054000 2.1192524 g__CAJMNU01 10 80.24600 2.5263000 2.6760628 g__Campylobacter_D 10 98.00700 0.3620000 1.6321909 g__Citrobacter 10 96.84800 1.3583000 4.9781595 g__Gastranaerophilus 10 91.38000 1.4039000 1.7364685 g__Paracoccus 10 81.77200 3.7998000 3.3388515 g__Parasutterella 10 76.43000 1.6548000 1.9784199 g__Phocea 10 76.18200 0.6550000 2.3518207 g__RF16 10 91.51100 1.0022000 2.2022190 g__RUG11200 10 91.10700 1.0880000 2.1560055 g__Stoquefichus 10 86.57200 1.2595000 2.8669295 g__UBA2942 10 83.23500 1.0328000 2.5558953 g__UBA7488 10 74.56400 2.1603000 1.2515580 g__VSOB01 10 85.29300 1.7899000 2.2543349 g__W0P33-017 10 73.26100 1.9180000 2.1671895 g__WRHT01 10 77.74800 0.9126000 2.5760728 g__Anaerostipes 9 93.58111 2.3318889 2.8693579 g__CAG-411 9 84.95222 2.9281111 3.3173622 g__Flavobacterium 9 87.84333 1.0174444 2.3221709 g__HGM11788 9 79.61778 1.6151111 1.9439003 g__MGBC101980 9 85.99111 0.6412222 1.8073716 g__MGBC116941 9 80.90889 0.9412222 1.5803504 g__MGBC133411 9 93.50111 0.7466667 1.6806793 g__Nanosyncoccus 9 75.71222 2.3200000 0.6446879 g__QXXE01 9 86.88556 1.8751111 2.3746221 g__RUG14156 9 80.28222 2.4695556 1.6172962 g__SIG299 9 89.24000 1.6131111 2.8418794 g__UBA2658 9 82.63667 1.0730000 1.8671253 g__UBA5026 9 73.84444 1.2355556 1.0706041 g__Aminipila 8 67.38000 0.9537500 2.0174397 g__Bifidobacterium 8 83.49000 2.7225000 1.9555551 g__CAG-1782 8 77.71625 0.7556250 1.6807365 g__CAG-603 8 80.65000 2.6758750 2.1526014 g__CAKSQF01 8 79.93625 0.9917500 2.0437717 g__CAMBRQ01 8 72.77875 2.1388750 2.2319374 g__Enterousia 8 80.78750 0.9765000 0.8433071 g__Eubacterium_G 8 88.17000 1.9582500 2.4612454 g__Fimimonas 8 95.00375 0.6475000 1.6851953 g__Gallalistipes 8 80.83375 2.7625000 2.1984795 g__Helicobacter_A 8 78.27625 0.8725000 1.8113489 g__Methanocorpusculum 8 77.16250 1.1595000 1.4272422 g__Pelethomonas 8 77.72125 2.9436250 1.8020724 g__Protoclostridium 8 86.06250 1.4588750 1.9700617 g__Pseudoruminococcus 8 90.94250 1.8950000 1.9282691 g__RGIG1896 8 79.69875 0.9085000 2.1137309 g__Stercorousia 8 88.21500 0.6935000 1.6315696 g__UBA2882 8 96.81375 2.0061250 3.1634651 g__UMGS1590 8 84.14000 1.2237500 1.6338101 g__UMGS1663 8 71.80125 3.8312500 1.2252721 g__WRKB01 8 69.86375 1.2117500 2.2358068 g__Acutalibacter 7 76.37857 3.0962857 2.1355971 g__Aquirickettsiella 7 91.59429 0.6900000 1.4428406 g__Budvicia 7 97.61571 1.1657143 4.9839689 g__C-53 7 84.15857 2.8560000 2.4678421 g__CAAEEV01 7 78.37286 1.1568571 2.1891347 g__CAG-196 7 86.10714 3.0028571 1.6776744 g__CAG-288 7 80.87286 2.2087143 1.3704010 g__CAKVBE01 7 94.11000 0.4814286 1.2429151 g__CALVGN01 7 76.91714 2.6742857 1.2535426 g__Clostridium_AQ 7 91.90429 1.5045714 3.8387087 g__Craterilacuibacter 7 81.31286 1.7714286 2.5626826 g__Eubacterium_I 7 70.79000 3.5230000 2.2632804 g__Evtepia 7 75.27286 2.3128571 2.0705850 g__Faecimonas 7 81.89143 3.4434286 1.3994236 g__Fimivicinus 7 86.72000 1.6947143 2.4892343 g__Fimousia 7 87.43286 3.3242857 2.9347514 g__Galligastranaerophilus_A 7 91.51714 1.1527143 1.8972837 g__HGM11386 7 66.51286 0.9540000 1.9037451 g__JAAWBF01 7 68.22143 4.2802857 2.1013280 g__JAFLUQ01 7 91.93571 1.7872857 1.8426291 g__Klebsiella 7 86.03286 2.2102857 4.7065624 g__Lactobacillus 7 80.40714 1.6885714 1.5572434 g__Lactococcus 7 92.60429 0.2594286 2.0698919 g__MGBC105563 7 81.80429 2.0500000 1.3936926 g__Massiliimalia 7 92.06571 0.9414286 2.2584913 g__SIG332 7 72.63286 1.0757143 2.8571921 g__Staphylococcus 7 80.70286 3.1682857 2.4697476 g__UBA7050 7 77.48429 2.3168571 2.5983891 g__UBA7477 7 95.43143 0.9271429 2.1718556 g__UBA9732 7 92.63857 0.7142857 1.9370883 g__Ventrenecus 7 73.01000 3.8605714 1.2016906 g__Anaerocaecibacter 6 82.48333 1.0248333 1.5844930 g__Aphodocola 6 89.30167 1.9933333 1.0544425 g__Avigastranaerophilus 6 79.68833 2.5123333 1.7011832 g__Avilachnospira 6 89.08833 2.0816667 1.9312978 g__Bacteroides_G 6 85.11167 1.1333333 2.8740010 g__Butyrivibrio_A 6 91.26167 1.1013333 2.0931528 g__CAG-267 6 85.30500 0.4736667 1.5094952 g__CAG-56 6 74.37000 3.2266667 2.4492095 g__CAKRHR01 6 79.97000 0.6291667 1.5974582 g__Caccovicinus 6 79.73000 4.4755000 3.3505713 g__Enterococcus_B 6 86.41167 2.5198333 2.3803343 g__Fimimorpha 6 77.44333 2.1108333 2.6436418 g__Hepatoplasma 6 88.72833 0.4470000 0.6053618 g__Holdemanella 6 83.08000 3.7516667 1.8317410 g__JAHHSE01 6 76.31500 2.8426667 1.7155948 g__JAHHTP01 6 75.32667 1.0483333 2.0716533 g__JALEPO01 6 83.87500 1.0821667 2.4868445 g__Limadaptatus 6 88.71167 0.7150000 1.5034233 g__Limosilactobacillus 6 83.34333 2.6183333 1.7134198 g__Luteimonas_D 6 74.00000 3.2250000 2.0614148 g__Merdenecus 6 81.18333 2.4440000 1.9822702 g__Muricomes 6 79.38000 2.8978333 4.4555923 g__Onthocola_B 6 84.07667 3.0303333 1.2408505 g__Paenalcaligenes 6 86.16667 2.3341667 2.1055687 g__Pseudomonas_E 6 73.11667 1.9236667 4.1134410 g__RGIG3040 6 93.30000 1.1191667 2.4830408 g__RGIG6919 6 98.79667 1.0395000 2.5789765 g__Romboutsia_C 6 73.38167 4.3161667 2.1242698 g__SIG32 6 61.97833 3.4913333 1.3262683 g__Salmonella 6 92.35333 2.8268333 4.4804432 g__UBA1213 6 78.93833 0.7800000 1.9680687 g__UBA5884 6 84.30000 0.4650000 2.0255830 g__UBA6857 6 73.85500 2.8083333 1.4368093 g__Zag111 6 82.49833 2.9865000 1.7315908 g__Alistipes_A 5 67.81000 1.1260000 1.4825886 g__Anaerobiospirillum_A 5 86.48800 0.4640000 2.1656050 g__CALXRO01 5 75.59800 1.3176000 0.9162908 g__Caccocola 5 90.27600 1.0400000 1.9677128 g__Coprobacter 5 82.76200 0.9980000 2.9099868 g__Dietzia 5 65.72800 3.4980000 2.4245102 g__Faeciplasma 5 93.68800 0.6060000 2.2825556 g__Harryflintia 5 80.60600 0.9074000 2.8972694 g__Lactonifactor 5 83.84600 2.9700000 3.5624752 g__MGBC163490 5 77.85200 2.4320000 2.1987082 g__Marseille-P3106 5 73.33600 3.2790000 1.8431378 g__Oliverpabstia 5 80.60200 1.7674000 2.9625534 g__Peptostreptococcus 5 91.83400 0.3300000 1.9281984 g__RGIG3102 5 74.74800 0.5740000 1.8622668 g__Scandinavium 5 76.26400 4.0674000 3.5725998 g__Streptococcus 5 84.95400 1.1840000 1.6940552 g__UBA1224 5 85.63200 1.5040000 2.1756520 g__UBA1794 5 84.96800 0.9356000 2.5147674 g__UBA4372 5 83.99600 0.6524000 2.4512498 g__UBA5578 5 90.46200 4.3400000 1.3501078 g__UBA940 5 63.52600 2.8382000 1.9487894 g__UMGS1202 5 69.63200 3.2966000 2.1889230 g__Ureaplasma 5 93.33800 2.8572000 0.8725570 g__Amedibacterium 4 82.13750 2.3450000 2.0251692 g__Brachybacterium 4 60.89000 4.6000000 2.4814907 g__Brachyspira 4 80.90000 1.2175000 2.3866602 g__CAG-449 4 91.76250 1.0625000 1.5513553 g__CAG-452 4 79.59250 3.3300000 1.2745943 g__CAG-510 4 80.43500 0.9660000 2.3178183 g__CAG-552 4 73.48750 4.7050000 1.3769327 g__CAG-977 4 77.08000 2.4092500 1.9460518 g__CAIPUE01 4 80.56500 0.4625000 1.5747565 g__CAJTFG01 4 82.45500 3.5237500 1.7213820 g__CAKTEE01 4 91.33750 1.1575000 2.4731025 g__CALTSX01 4 92.91000 0.6202500 1.2099883 g__Cellulosilyticum 4 86.23000 2.2075000 3.1873197 g__Cetobacterium_A 4 85.48000 2.7900000 2.2040432 g__Clostridium_J 4 81.78000 0.5700000 2.2824030 g__Cryptoclostridium 4 86.94000 0.6075000 1.7945513 g__DTU064 4 86.46000 1.0125000 1.7178478 g__Extibacter 4 81.18250 2.3687500 3.1953317 g__Faecenecus 4 84.84500 2.6200000 1.2000395 g__Faecivivens 4 71.64250 2.0625000 2.3213278 g__HGM16780 4 68.42500 3.0875000 1.1982293 g__Harrysmithimonas 4 87.94000 2.0750000 2.2354865 g__Helicobacter_B 4 88.63750 1.3825000 1.7077433 g__IOR16 4 87.13750 0.9137500 2.2664415 g__ISDg 4 92.15750 1.0257500 2.2986802 g__JAFUYI01 4 87.55500 3.0075000 1.3939207 g__JAJPXI01 4 77.56500 4.2525000 1.8635177 g__MGBC107952 4 70.80500 2.2402500 1.0953345 g__MGBC114844 4 75.18750 1.3825000 2.5196693 g__Mammaliicoccus 4 90.05250 2.0452500 2.4904173 g__Merdicola 4 77.20500 3.4107500 1.6477073 g__Moheibacter 4 98.35000 0.2000000 2.6458937 g__Morganella 4 97.77500 1.5805000 3.8062090 g__Onthousia 4 64.59750 0.9575000 0.8624597 g__Onthovicinus 4 88.43000 0.2477500 2.1550255 g__Onthovivens 4 88.40500 1.4025000 1.5085552 g__Pseudoscilispira 4 69.95000 3.8690000 1.9631340 g__RGIG6307 4 79.84000 3.6200000 2.7167807 g__RGIG9287 4 76.25500 0.5290000 1.2484727 g__Ruminococcus_C 4 84.85500 1.2375000 2.0969247 g__SFTH01 4 64.97000 2.3650000 2.0539450 g__SIG200 4 86.12500 1.1175000 1.2774717 g__Spiro-02 4 98.42250 1.6607500 3.5823728 g__UBA1174 4 99.53000 0.2350000 1.6857845 g__UBA11957 4 80.12250 3.4475000 2.9138833 g__UBA1221 4 69.62250 1.6497500 1.5082585 g__UBA1417 4 74.56250 2.2625000 1.9141827 g__UBA6398 4 87.35000 1.3335000 2.3518997 g__UMGS2016 4 73.03000 2.9962500 1.2313167 g__1XD42-69 3 71.61000 1.1433333 2.2772987 g__Anaerosphaera 3 98.75333 0.9000000 1.6050477 g__Bariatricus 3 81.43000 1.8856667 3.0292130 g__Bullifex 3 93.03000 0.7500000 2.2470177 g__CAG-266 3 99.85333 0.1966667 1.8609273 g__CAG-465 3 74.60000 3.7193333 1.4152633 g__CAKUFA01 3 61.60333 4.2900000 2.0538507 g__CALUVN01 3 90.21667 0.8546667 1.9001530 g__CALXSC01 3 90.36667 1.1800000 1.4654037 g__Caccenecus 3 75.47667 4.2956667 1.0729603 g__Catenibacterium 3 88.83333 1.1033333 1.8893763 g__Copranaerobaculum 3 76.24000 2.4876667 2.3575910 g__Deefgea 3 72.25667 4.5933333 2.1838040 g__Dialister 3 85.23667 1.5466667 2.0520430 g__Eggerthella 3 75.66667 1.9503333 2.6020303 g__Enterococcus_A 3 67.69000 5.4523333 3.1184757 g__F23-B02 3 91.86333 0.5033333 1.8480567 g__Faecalitalea 3 81.71333 1.6866667 1.4002217 g__Faecisoma 3 83.11333 1.3016667 1.2345163 g__Fimicola 3 93.99000 0.7566667 2.2741243 g__Helicobacter_G 3 100.00000 0.0000000 1.5149717 g__Howiella 3 68.67000 0.4400000 1.5884423 g__Ignatzschineria 3 88.72000 2.5533333 2.2076030 g__JAEDES01 3 71.45000 3.9300000 1.0537700 g__JAFLTL01 3 76.91000 2.5076667 2.0471750 g__JAHHTG01 3 95.12667 0.8433333 1.5645583 g__JAJQCF01 3 95.24000 0.1766667 1.9402947 g__JAJYSO01 3 81.81000 2.9160000 2.7890990 g__KLE1615 3 77.86667 2.9933333 2.7740737 g__MGBC113645 3 68.09000 1.4726667 2.2981643 g__Merdimorpha 3 80.58000 0.7300000 1.5979100 g__Methanosphaera 3 94.84333 0.0900000 1.6529157 g__Microbacterium 3 83.60667 3.0493333 2.3846987 g__Oceanisphaera 3 97.68333 0.5233333 2.7258257 g__Oxalobacter 3 95.19667 0.9340000 2.2284007 g__Paraclostridium 3 82.09000 5.7133333 2.6121447 g__RGIG4140 3 83.61333 1.8100000 1.3726980 g__RGIG5270 3 90.75667 0.3566667 3.3269373 g__RGIG7114 3 81.37667 1.6196667 1.7242390 g__RGIG8607 3 90.59000 1.8000000 3.0420217 g__RUG11788 3 94.44333 0.9000000 1.5367053 g__Romboutsia 3 67.71667 6.4966667 2.6357960 g__Scatavimonas 3 94.25667 0.6403333 2.4870867 g__Thiopseudomonas 3 88.37000 1.5843333 2.3411610 g__UBA11774 3 95.11000 1.5036667 2.7622537 g__UBA71 3 78.07333 0.7300000 1.5585433 g__Vagococcus 3 70.64667 3.9500000 1.8589267 g__WQYD01 3 73.71667 1.7333333 1.5869717 g__12844 2 79.00500 6.0600000 2.1416225 g__Acaricomes 2 83.10500 0.3850000 1.9028050 g__Adamsella 2 97.65500 2.4650000 2.0072200 g__Aliidiomarina 2 74.38500 1.9065000 2.0012745 g__Avelusimicrobium 2 82.78000 1.6265000 1.2236500 g__Bacilliculturomica 2 74.25500 4.7325000 1.9710975 g__Beduini 2 84.23000 2.4380000 2.2955885 g__Brevibacterium 2 82.47000 3.8550000 3.8045630 g__Buchnera 2 97.52500 0.3550000 0.5724305 g__CAG-1031 2 91.04500 0.8350000 2.4178530 g__CAG-177 2 74.24000 1.4700000 1.5575055 g__CAG-217 2 61.65500 1.5600000 1.2425230 g__CAG-273 2 89.40500 2.3500000 1.3872975 g__CAG-492 2 75.24000 4.7050000 1.4435255 g__CAG-793 2 84.47500 3.6200000 1.7793720 g__CAIVKH01 2 72.66000 0.7850000 4.9133520 g__CAJAUT01 2 80.02000 4.0550000 0.7575565 g__CAJKWP01 2 67.99500 1.2455000 0.9406700 g__CAKQDS01 2 95.05000 2.4215000 2.1544285 g__CALWPC01 2 78.11500 1.1110000 1.8187095 g__CALXFK01 2 82.88000 1.0650000 1.8610855 g__CALXUC01 2 59.83000 3.9925000 1.1811290 g__CALXWF01 2 64.83500 0.2385000 1.0493780 g__CCUG-7971 2 61.44500 7.9750000 2.0359945 g__Catellicoccus 2 81.70000 0.9850000 0.9953495 g__Cloacibacillus 2 99.82500 1.4000000 3.5342340 g__Clostridium_AI 2 98.46000 4.8750000 4.0632260 g__Clostridium_H 2 73.49000 7.8800000 1.2955745 g__Clostridium_N 2 85.87000 1.4940000 1.9298470 g__DXYV01 2 69.56500 3.8600000 2.3761105 g__Dwaynesavagella 2 98.58000 1.1000000 1.8719920 g__E4-60 2 84.33500 3.2300000 1.7521075 g__Enterococcus 2 89.61000 0.5100000 2.7818710 g__Enterococcus_D 2 91.22500 1.0255000 3.1736100 g__FEN-1279 2 93.71000 0.9500000 3.3412970 g__FLUQ01 2 87.40000 2.0750000 3.1562155 g__Fluviibacter 2 73.96000 0.2360000 1.4886875 g__Frisingicoccus 2 83.62000 1.5335000 1.9329985 g__Fructobacillus 2 70.85000 1.3335000 1.0711470 g__GCA-900066495 2 80.64500 4.2450000 2.5389705 g__Gelidibacter 2 84.29500 0.4085000 3.9530615 g__Gordonia 2 63.57500 2.9050000 2.7385515 g__HGM05190 2 95.21500 1.8650000 2.7495455 g__HGM10766 2 87.59500 1.3950000 1.2461340 g__HGM13010 2 78.15000 1.0950000 1.9354615 g__HGM13233 2 88.11000 1.4355000 1.8582025 g__Helicobacter_D 2 72.05000 1.0400000 1.2014595 g__Heteroruminococcus 2 54.42500 0.5650000 1.3552695 g__JAAWPK01 2 85.27500 7.7250000 1.5044165 g__JAEZVV01 2 80.86500 1.5450000 2.1854740 g__JAGPHI01 2 92.36000 0.0800000 2.4903040 g__JAHHUI01 2 96.89500 0.6500000 1.4954395 g__JAJQAW01 2 69.89000 3.1600000 1.7257710 g__JAJQBJ01 2 77.29500 4.7500000 1.8839255 g__JAJQEJ01 2 80.75500 1.8500000 3.2014105 g__JAJYTI01 2 92.89500 1.0135000 2.6041895 g__Jeotgalibaca 2 77.31500 3.4000000 2.3815695 g__Jeotgalicoccus 2 90.42000 2.9900000 1.8986735 g__Kluyvera 2 99.81500 0.4650000 4.6310820 g__Kosakonia 2 96.01000 3.6050000 5.3340235 g__LD21 2 84.63500 0.6050000 3.6092415 g__Limivivens 2 73.86000 1.4300000 3.2345895 g__Limnohabitans 2 95.05500 4.2200000 2.3905355 g__Lysinibacillus 2 95.22000 0.0220000 4.2795200 g__MGBC108787 2 88.51500 2.5365000 1.0434780 g__MGBC162267 2 86.14000 0.9600000 1.1269010 g__Mediterraneibacter 2 77.31500 2.0250000 1.6486825 g__Novisyntrophococcus 2 68.38000 2.2400000 1.9206375 g__Onthenecus 2 52.91500 7.1500000 3.0607900 g__Ornithomonoglobus 2 82.84000 0.9350000 2.2415495 g__Pantoea 2 75.57000 2.8620000 5.0193540 g__PeH17 2 87.94500 1.8500000 1.6687780 g__Proteus 2 99.62500 0.2950000 3.7820085 g__Psychrobacter 2 75.12000 4.4350000 2.0303495 g__RACS-047 2 67.86000 1.4200000 1.4849975 g__RGIG1902 2 78.71000 2.0075000 1.6448660 g__RGIG3926 2 92.44500 0.6650000 1.7516480 g__RGIG4074 2 78.60500 1.0530000 1.7612830 g__RGIG4097 2 96.65000 0.3620000 1.4873745 g__RGIG4790 2 93.55500 2.0150000 0.9155400 g__RGIG5057 2 94.79000 0.1100000 1.3017250 g__RUG12438 2 91.78000 3.3150000 1.3415855 g__RUG12867 2 85.03000 0.8625000 1.1426110 g__Raoultibacter 2 63.28000 4.4025000 1.7240865 g__Robinsoniella 2 99.51000 1.2525000 6.0692840 g__SIG308 2 79.21500 3.5050000 2.4088480 g__Scatosoma 2 73.76500 0.1350000 1.9165610 g__Scybalousia 2 88.93000 0.7260000 1.4103565 g__Serratia_A 2 93.35000 1.5250000 4.6943715 g__Shewanella 2 95.18000 1.9850000 4.2699450 g__Smithella 2 94.25000 5.0250000 3.3927685 g__Succinivibrio 2 96.45000 0.3200000 2.5095410 g__TWA4 2 78.67000 2.5550000 2.8554845 g__Thiodictyon 2 73.78500 2.9200000 4.1131270 g__Tyzzerella 2 84.23000 0.6750000 1.4449830 g__UBA11358 2 86.94000 3.1400000 3.7858265 g__UBA11524 2 86.84000 2.4685000 2.9045465 g__UBA2475 2 85.26500 2.3150000 3.1131990 g__UBA3903 2 80.10500 0.0835000 1.8982870 g__UBA6265 2 74.64500 1.6650000 2.6058865 g__UMGS1585 2 73.24000 4.1195000 1.8699425 g__UMGS2069 2 82.80500 1.1100000 0.9754800 g__UMGS75 2 91.98000 0.8400000 1.5794495 g__UMGS995 2 88.62000 2.2650000 1.3178675 g__Veillonella_A 2 93.89500 0.3450000 2.2712830 g__Wohlfahrtiimonas 2 76.77000 2.1600000 1.5439760 g__2-01-FULL-39-10-A 1 80.19000 3.3500000 0.7863970 g__51-20 1 100.00000 0.8700000 1.5491530 g__Aerococcus 1 59.02000 8.6300000 1.3373320 g__Aeromicrobium 1 99.89000 0.6400000 2.8213450 g__Agrococcus 1 98.43000 0.0300000 2.5044110 g__Alangreenwoodia 1 96.93000 0.1200000 3.1569430 g__Albibacterium 1 99.97000 0.3000000 3.7405060 g__Alcaligenes 1 56.61000 6.1300000 2.7206030 g__Arachnia 1 56.85000 0.2300000 1.7251140 g__Avipropionibacterium 1 98.71000 2.5600000 3.6400790 g__Avispirillum 1 87.34000 0.9700000 1.8022740 g__Bacteroides_E 1 99.43000 0.4500000 2.6663310 g__Bacteroides_H 1 95.02000 0.5660000 3.4673400 g__Barb7 1 98.58000 0.6200000 6.1182190 g__Barnesiella 1 99.35000 0.0900000 3.0426880 g__Borkfalkia 1 78.95000 4.4800000 1.7753920 g__Bradyrhizobium 1 62.81000 1.7500000 5.0405010 g__C7867-006 1 90.27000 8.1700000 0.7971490 g__CAG-1193 1 64.91000 0.6700000 1.2539700 g__CAG-170 1 85.03000 0.1900000 2.0396770 g__CAG-272 1 78.92000 0.6900000 1.5878050 g__CAG-313 1 69.08000 2.0900000 1.4483860 g__CAG-314 1 87.89000 1.0700000 1.3074640 g__CAG-433 1 92.35000 2.4400000 1.3596480 g__CAG-582 1 92.69000 0.0000000 1.2631680 g__CAIPTY01 1 50.25000 7.7900000 2.9839400 g__CAIQJJ01 1 53.49000 2.3600000 3.4070360 g__CAIQQL01 1 90.32000 0.2600000 1.1657700 g__CAIRTM01 1 61.85000 8.6300000 4.9539890 g__CAJMSU01 1 88.06000 1.0400000 1.0920350 g__CAKOLD01 1 62.29000 0.5800000 0.9057680 g__CAKVJS01 1 71.20000 1.4150000 2.2007280 g__CAKVLS01 1 69.22000 0.5900000 0.7301980 g__CALVUN01 1 57.65000 9.6490000 2.3278350 g__CALVXC01 1 92.39000 1.9100000 1.0055050 g__CALWOS01 1 53.90000 1.0900000 1.6640440 g__CALWTV01 1 82.28000 1.0700000 2.4557110 g__CALXEL01 1 79.08000 2.0740000 2.2882710 g__CALXJL01 1 75.30000 1.7600000 1.1251280 g__CALXVS01 1 70.63000 1.5300000 1.0296420 g__Caccosoma 1 89.73000 1.6850000 1.2940300 g__Cardinium 1 84.75000 0.5000000 0.7669200 g__Chiayiivirga 1 92.95000 0.2100000 2.9693770 g__Chlorobaculum 1 65.18000 1.3000000 1.5352380 g__Citrobacter_A 1 97.08000 3.1420000 4.8801630 g__Clostridioides 1 99.30000 0.0000000 4.2129860 g__Clostridium_AH 1 60.75000 2.9200000 1.9427030 g__Coprococcus_A 1 82.82000 1.0800000 2.5061970 g__Coprosoma 1 71.52000 3.9200000 0.9925660 g__Croceibacterium 1 75.11000 2.4700000 2.0738110 g__Cryomorpha 1 56.69000 1.6120000 2.0112330 g__DUUI01 1 97.85000 0.0800000 1.5162980 g__DUUS01 1 62.00000 8.9500000 2.2742990 g__DYRC01 1 81.39000 3.7300000 4.0181950 g__Diplocloster 1 50.94000 1.2000000 1.3238920 g__Duodenibacillus 1 94.85000 1.1100000 2.1803970 g__Dysgonomonas 1 98.90000 0.5640000 2.5705980 g__Edwardsiella 1 90.83000 0.5200000 2.8654900 g__Enterococcus_J 1 50.72000 1.1700000 0.9908680 g__Erysipelothrix 1 99.95000 3.2900000 2.1357920 g__FEN-1139 1 97.42000 7.9000000 11.3623140 g__Fermentimonas 1 99.97000 0.1000000 3.9489400 g__Fimiplasma 1 96.94000 0.0500000 1.5553540 g__Firm-04 1 67.01000 2.3400000 1.2865310 g__Frigididesulfovibrio 1 94.73000 0.0700000 3.0212370 g__Fusicatenibacter 1 97.59000 0.7300000 2.8192670 g__GCA-2737665 1 86.70000 3.0200000 4.5378670 g__Gallibacter 1 96.32000 0.2600000 1.8428150 g__Galligastranaerophilus 1 99.93000 2.5400000 1.7457010 g__Geddesella 1 96.73000 0.0300000 2.1005630 g__Gilvimarinus 1 96.32000 0.4310000 3.0208880 g__HGM11525 1 67.71000 3.4000000 2.5100260 g__HGM12545 1 76.13000 3.4800000 2.2671200 g__HGM13006 1 65.47000 1.4100000 1.8800760 g__Halomonas 1 54.30000 8.2900000 2.0029490 g__Halopseudomonas 1 72.55000 2.3400000 2.4694990 g__Holdemania 1 94.52000 0.0000000 3.0449160 g__Holophaga 1 71.42000 4.6500000 3.2369970 g__Hominisplanchenecus 1 52.63000 9.1700000 2.0338570 g__Hylemonella 1 56.38000 0.4800000 1.2174180 g__IGN3 1 94.67000 1.7400000 4.0465950 g__JAAYKM01 1 93.11000 4.5600000 2.4479890 g__JAAYLC01 1 91.25000 1.4570000 2.6996670 g__JAAYSD01 1 97.14000 0.8000000 2.2232730 g__JAAYVZ01 1 59.41000 1.3700000 4.0375160 g__JAAZDN01 1 81.34000 1.5600000 1.6726130 g__JABFSR01 1 79.06000 2.8400000 4.0676450 g__JABUSF01 1 67.08000 0.0500000 1.0973490 g__JACRCG01 1 99.99000 1.2000000 3.6243310 g__JACRJP01 1 64.10000 0.4300000 0.5241010 g__JADKHC01 1 96.07000 0.9200000 4.2325610 g__JADLHS01 1 69.19000 5.2800000 4.5299160 g__JAERTD01 1 78.85000 1.0800000 2.4014670 g__JAEWLZ01 1 62.06000 1.9580000 1.0931320 g__JAFAFE01 1 84.78000 1.4900000 2.4148500 g__JAFGIC01 1 79.70000 5.2500000 3.5743770 g__JAFGVL01 1 50.93000 8.6800000 2.5758390 g__JAFTYR01 1 100.00000 0.6200000 3.0245750 g__JAGNPU01 1 91.60000 1.4900000 2.7235160 g__JAGOBP01 1 68.76000 1.3700000 2.5018200 g__JAGVVH01 1 66.67000 1.3620000 1.9102400 g__JAGZEG01 1 52.40000 3.7300000 1.5758530 g__JAHHTM01 1 50.03000 8.9230000 4.3682840 g__JAHZHG01 1 69.92000 5.7600000 2.6796420 g__JAILHT01 1 80.35000 0.6900000 3.0262580 g__JAILQS01 1 64.51000 8.3900000 2.7006730 g__JAJYRX01 1 99.52000 0.0000000 2.7910880 g__JAKALQ01 1 50.86000 2.9100000 1.5432920 g__JALENY01 1 81.94000 0.0200000 2.5501840 g__JALRDG01 1 86.80000 0.3000000 0.7550770 g__JAMLIO01 1 96.59000 1.3200000 2.4054180 g__JJ008 1 100.00000 0.3300000 4.2966590 g__KH17 1 93.27000 0.2400000 2.3694440 g__Lachnoclostridium 1 92.39000 1.3420000 4.1176900 g__Lachnoclostridium_B 1 90.38000 1.4610000 2.8312080 g__Lactococcus_A 1 99.74000 1.0900000 2.5777500 g__Lamprocystis 1 56.68000 1.1000000 3.4572690 g__Lapidilactobacillus 1 100.00000 0.9200000 1.8477010 g__Leclercia 1 64.84000 1.4800000 2.7951050 g__Lentilactobacillus 1 65.07000 3.1900000 1.0477630 g__Leuconostoc 1 74.42000 6.7100000 1.4773370 g__Limousia 1 89.53000 1.3420000 1.6878580 g__Longicatena 1 57.38000 0.5000000 1.3931710 g__Lumbricidophila 1 56.10000 1.2790000 1.5382050 g__Luteimonas 1 73.36000 0.1000000 1.9674930 g__Luteolibacter 1 74.78000 0.9600000 3.1301400 g__MGBC102946 1 53.58000 0.2500000 0.6341430 g__MGBC140090 1 95.54000 1.0200000 2.1087060 g__MGBC143601 1 95.88000 0.4400000 1.1444400 g__MGBC163016 1 67.37000 2.2900000 1.3527210 g__Marinobacter 1 50.85000 2.0600000 1.5248470 g__Mediterraneibacter_A 1 64.46000 3.0070000 2.5245340 g__Metalachnospira 1 64.26000 2.7600000 1.8286310 g__Methanobacterium_A 1 96.44000 0.1100000 2.2352770 g__Methanomethylophilus 1 98.38000 0.8060000 1.6299110 g__Methanoplasma 1 95.48000 1.1600000 1.2943750 g__Methanoregula 1 58.96000 9.9300000 1.7568370 g__Methanothrix 1 96.26000 0.3900000 2.3085830 g__Methyloglobulus 1 66.74000 2.0400000 2.2778330 g__Methylophaga 1 100.00000 0.1400000 2.3533740 g__Mycetocola 1 93.00000 4.1700000 3.4344310 g__NC2004 1 53.18000 3.3800000 1.6265820 g__NIC37A-2 1 55.66000 0.1600000 2.5307600 g__Novimethylophilus 1 99.26000 0.8500000 3.0861980 g__OLB17 1 89.84000 1.5100000 3.9879030 g__Oligella 1 99.74000 3.5500000 2.2122110 g__Onthoplasma 1 97.69000 0.2100000 1.1555950 g__Ornithomonoglobus_A 1 51.34000 7.2500000 1.7475840 g__Paenibacillus 1 98.92000 0.0000000 3.8814710 g__Paludibacter 1 100.00000 3.2200000 4.5095440 g__Paracandidimonas 1 67.42000 2.5900000 2.8729410 g__Paratractidigestivibacter 1 68.21000 0.6600000 1.3958120 g__Pelagibacterium 1 59.50000 1.6900000 2.3088470 g__Phyllobacterium 1 97.02000 1.7390000 5.2746640 g__Planktothrix 1 98.21000 0.0500000 5.4178210 g__Proteiniphilum 1 99.96000 0.5500000 2.9177370 g__Providencia 1 91.23000 2.5800000 4.2267620 g__Pseudochrobactrum 1 51.22000 4.7400000 1.9998690 g__Pseudocitrobacter 1 96.28000 8.7140000 4.8484100 g__Pseudomonas 1 76.97000 0.2750000 4.2230230 g__Pusillimonas_B 1 99.99000 0.6700000 3.9399620 g__RFTN01 1 81.02000 0.9200000 0.7832210 g__RGDT01 1 72.40000 3.7200000 6.1226800 g__RGIG2219 1 72.74000 1.2600000 1.4807870 g__RGIG2774 1 99.33000 0.1700000 2.0010970 g__RGIG3091 1 92.13000 1.6850000 1.2119560 g__RGIG3701 1 93.11000 1.7300000 4.3173220 g__RGIG423 1 53.64000 0.7380000 1.1266110 g__RGIG7389 1 71.24000 3.2900000 2.0355290 g__RPPU01 1 92.58000 2.0000000 4.3118760 g__RUG11130 1 91.69000 0.2300000 2.1081430 g__RUG11198 1 63.63000 9.1520000 1.7405860 g__RUG11890 1 79.65000 1.6800000 1.0271300 g__RUG11977 1 87.04000 0.0700000 2.3311150 g__RUG14305 1 55.47000 8.9500000 2.9488890 g__RUG14891 1 54.46000 8.7550000 3.7555800 g__RUG591 1 92.44000 2.0900000 1.5980810 g__Rahnella 1 92.85000 1.3330000 5.0810120 g__Rhodoblastus 1 100.00000 4.6700000 3.9048080 g__Rhodoferax_C 1 98.54000 2.8300000 5.2482630 g__Romboutsia_D 1 72.82000 5.5700000 2.3550210 g__Rothia 1 92.70000 4.8700000 2.6861620 g__Ruania 1 92.31000 2.5000000 4.2623200 g__SIG230 1 85.17000 0.4000000 1.8732640 g__SIG350 1 97.20000 0.0400000 1.3345990 g__SIG603 1 65.91000 1.0060000 1.8239100 g__SKHV01 1 98.80000 1.0200000 5.6958050 g__Salinicoccus 1 98.89000 1.1800000 2.5098650 g__Scatomorpha 1 58.59000 2.4600000 1.4164590 g__Schmidhempelia 1 99.97000 0.0400000 1.7264330 g__Schwartzia 1 52.37000 0.1700000 0.7808460 g__Serratia 1 92.52000 4.6410000 4.5124690 g__Slackia_A 1 63.54000 0.4800000 1.1501420 g__Sphingopyxis 1 50.44000 0.8200000 1.0650310 g__Spiroplasma 1 50.77000 0.1500000 0.3365380 g__Stackebrandtia 1 98.96000 0.5600000 3.4912210 g__Stenotrophomonas 1 87.83000 0.6350000 3.6664510 g__Stutzerimonas 1 55.33000 5.6800000 2.0687660 g__Symbiothrix 1 95.27000 0.1700000 2.5798760 g__Syntrophorhabdus 1 81.00000 5.4100000 2.3275200 g__TH-plancto1 1 99.99000 1.4400000 6.7033310 g__Taishania 1 81.78000 2.0400000 2.7747980 g__Terracidiphilus 1 81.62000 1.9100000 4.2092490 g__Tomitella 1 52.50000 0.0000000 1.7374670 g__UBA10108 1 83.73000 2.2300000 0.8763760 g__UBA1081 1 74.56000 1.3420000 1.8937540 g__UBA11452 1 55.89000 2.6900000 3.2786740 g__UBA11704 1 58.56000 5.9100000 1.7787750 g__UBA1306 1 56.40000 7.3600000 2.4632840 g__UBA1394 1 50.00000 9.0400000 3.0054700 g__UBA1405 1 50.63000 0.3100000 1.7731710 g__UBA1752 1 75.44000 1.6200000 1.3302750 g__UBA2192 1 58.89000 1.3700000 1.2361280 g__UBA2664 1 97.46000 0.4600000 3.4316890 g__UBA2813 1 82.64000 1.9900000 1.6820780 g__UBA2883 1 80.37000 2.0600000 1.6062150 g__UBA3305 1 50.33000 8.1400000 1.6613950 g__UBA3789 1 93.82000 5.1200000 1.6781770 g__UBA3961 1 97.88000 1.3800000 3.6846550 g__UBA4132 1 99.97000 0.1600000 3.6971890 g__UBA4636 1 59.95000 0.0000000 1.0069370 g__UBA6186 1 81.33000 1.2400000 1.2543920 g__UBA6345 1 93.11000 0.2680000 1.2527190 g__UBA710 1 98.31000 0.7700000 0.7858270 g__UBA738 1 67.50000 0.1100000 1.1998320 g__UBA7405 1 78.78000 2.2400000 3.7474390 g__UBA933 1 85.84000 0.9000000 2.0666030 g__UBA9973 1 100.00000 0.4100000 0.6731830 g__UMGS1071 1 65.41000 1.9500000 1.2617750 g__UMGS1124 1 86.95000 1.2100000 1.2401560 g__UMGS1271 1 81.36000 0.3000000 1.0862590 g__UMGS1696 1 96.30000 0.0200000 2.5538520 g__UMGS1754 1 74.25000 0.8940000 1.5509920 g__UMGS1766 1 71.53000 1.4540000 2.1316140 g__UMGS1781 1 100.00000 3.1600000 1.6879910 g__UMGS1994 1 57.91000 0.5100000 0.7209690 g__UMGS363 1 91.75000 0.0800000 2.6035780 g__UMGS687 1 69.42000 0.8060000 0.7448230 g__UMGS946 1 88.78000 0.8060000 1.8872360 g__UMGS973 1 86.09000 1.9300000 1.5602950 g__Vitreimonas 1 57.65000 1.1400000 1.7915160 g__Wolbachia 1 98.71000 0.0000000 1.3209310 g__Zhenhengia 1 98.22000 0.6300000 3.4406380 #top 50 genera genus_top50 &lt;- genome_metadata %&gt;% group_by(genus) %&gt;% summarise(genomes=n()) %&gt;% arrange(-genomes) %&gt;% filter(genus != &quot;g__&quot;) %&gt;% pull(genus) %&gt;% head(n=100) 5.4 New taxa discovery #species genome_metadata %&gt;% mutate(novelty = if_else(species == &quot;s__&quot;, &quot;new&quot;, &quot;known&quot;)) %&gt;% group_by(novelty) %&gt;% summarise( total_genomes = n(), percentage = (total_genomes / nrow(genome_metadata)) * 100 ) %&gt;% tt() .table td.tinytable_css_id98vlvc856oydhkahohwt, .table th.tinytable_css_id98vlvc856oydhkahohwt { border-bottom: solid 0.1em #d3d8dc; } novelty total_genomes percentage known 2127 12.04008 new 15539 87.95992 #genus genome_metadata %&gt;% mutate(novelty = if_else(genus == &quot;g__&quot;, &quot;new&quot;, &quot;known&quot;)) %&gt;% group_by(novelty) %&gt;% summarise( total_genomes = n(), percentage = (total_genomes / nrow(genome_metadata)) * 100 ) %&gt;% tt() .table td.tinytable_css_id5jsnjda2mpzkhen4avqv, .table th.tinytable_css_id5jsnjda2mpzkhen4avqv { border-bottom: solid 0.1em #d3d8dc; } novelty total_genomes percentage known 14899 84.33714 new 2767 15.66286 #order genome_metadata %&gt;% mutate(novelty = if_else(order == &quot;o__&quot;, &quot;new&quot;, &quot;known&quot;)) %&gt;% group_by(novelty) %&gt;% summarise( total_genomes = n(), percentage = (total_genomes / nrow(genome_metadata)) * 100 ) %&gt;% tt() .table td.tinytable_css_iddr344zddgp2odgwxg4ko, .table th.tinytable_css_iddr344zddgp2odgwxg4ko { border-bottom: solid 0.1em #d3d8dc; } novelty total_genomes percentage known 17655 99.9377335 new 11 0.0622665 #species genome_metadata %&gt;% left_join(assembly_metadata,by=&quot;assembly_id&quot;) %&gt;% left_join(summary_table,by=&quot;rawdata_id&quot;) %&gt;% mutate(novelty = if_else(species == &quot;s__&quot;, &quot;new&quot;, &quot;known&quot;)) %&gt;% group_by(host_species) %&gt;% summarise( total_genomes = n(), new_genomes = sum(novelty == &quot;new&quot;), percentage_new = (new_genomes / total_genomes) * 100 ) %&gt;% arrange(desc(percentage_new)) %&gt;% tt() .table td.tinytable_css_ide9b00b0c7jcjasg9chjy, .table th.tinytable_css_ide9b00b0c7jcjasg9chjy { border-bottom: solid 0.1em #d3d8dc; } host_species total_genomes new_genomes percentage_new Podarcis muralis 3331 3248 97.50826 Podarcis gaigeae 1565 1524 97.38019 Podarcis milensis 766 741 96.73629 Sciurus carolinensis 2186 2098 95.97438 Lissotriton helveticus 2050 1963 95.75610 Calotriton asper 970 921 94.94845 Podarcis pityusensis 1355 1271 93.80074 Podarcis filfolensis 893 821 91.93729 Podarcis liolepis 298 271 90.93960 Trichosurus vulpecula 94 83 88.29787 Strix aluco 28 24 85.71429 Lepus europaeus 1053 902 85.66002 Sciurus vulgaris 1286 934 72.62830 Psittacula echo 166 88 53.01205 Canis familiaris 1625 650 40.00000 5.5 Microbial phylogenies genus_host &lt;- genome_metadata %&gt;% left_join(assembly_metadata,by=&quot;assembly_id&quot;) %&gt;% left_join(summary_table,by=&quot;rawdata_id&quot;) %&gt;% select(phylum,genus,host_species) %&gt;% filter(genus != &quot;g__&quot;) %&gt;% group_by(phylum,genus,host_species) %&gt;% summarise(genomes=n()) %&gt;% arrange(-genomes) %&gt;% ungroup() genus_host_spread &lt;- genus_host %&gt;% group_by(phylum,genus) %&gt;% summarise(host_species=n()) %&gt;% arrange(-host_species) 5.5.1 Bacteria gtdb_tree &lt;- read_tree(&quot;data/bac120_r214.tree&quot;) gtdb_metadata &lt;- read_tsv(&quot;data/bac120_taxonomy_r214.tsv.gz&quot;, col_names = FALSE) %&gt;% rename(genome=1,classification=2) %&gt;% separate(classification, c(&quot;domain&quot;,&quot;phylum&quot;,&quot;class&quot;,&quot;order&quot;,&quot;family&quot;,&quot;genus&quot;,&quot;species&quot;), sep =&quot;;&quot;) represented_genera &lt;- gtdb_metadata %&gt;% filter(genus %in% genus_host$genus) %&gt;% filter(genome %in% gtdb_tree$tip.label) %&gt;% group_by(genus) %&gt;% slice_sample(n = 1) %&gt;% ungroup() ehi_mags_tree &lt;- keep.tip(gtdb_tree, tip=represented_genera$genome) ehi_mags_tree$tip.label &lt;- represented_genera %&gt;% filter(genome %in% ehi_mags_tree$tip.label) %&gt;% # Keep only rows corresponding to tree tip labels arrange(match(genome, ehi_mags_tree$tip.label)) %&gt;% # Match order of genomes to tree tip labels pull(genus) genus_metadata &lt;- genome_metadata %&gt;% filter(phylum %in% selected_phyla) %&gt;% group_by(genus,phylum) %&gt;% summarise(count=n()) %&gt;% filter(genus %in% ehi_mags_tree$tip.label) phylum_metadata &lt;- genus_metadata %&gt;% group_by(phylum) %&gt;% summarise(node = MRCA(ehi_mags_tree, genus)) %&gt;% arrange(node) %&gt;% filter(node&gt;length(ehi_mags_tree$tip.label)) %&gt;% mutate(group = row_number()) ehi_mags_tree &lt;- groupClade(ehi_mags_tree, phylum_metadata$node) # Replace group numbers to phylum names current_groups &lt;- attributes(ehi_mags_tree)$group group_to_phylum &lt;- setNames(phylum_metadata$phylum, phylum_metadata$group) group_to_phylum &lt;- c(`0` = NA,group_to_phylum) new_groups &lt;- sapply(current_groups, function(g) { if (g %in% phylum_metadata$group) { return(group_to_phylum[g]) # Map numeric group to phylum name } else { return(NA) # Keep other nodes NA } }) %&gt;% unname() attributes(ehi_mags_tree)$group &lt;- new_groups #Plot tree ggtree(ehi_mags_tree, layout=&quot;equal_angle&quot;, aes(color = group)) %&lt;+% genus_metadata + geom_tippoint(aes(size = count, alpha=0.5)) + scale_size_continuous(range = c(1, 10)) + scale_color_manual(values = phylum_colors, na.value = &quot;black&quot;) + theme_void() gtdb_tree &lt;- read_tree(&quot;data/ar53_r214.tree&quot;) gtdb_metadata &lt;- read_tsv(&quot;data/ar53_taxonomy_r214.tsv.gz&quot;, col_names = FALSE) %&gt;% rename(genome=1,classification=2) %&gt;% separate(classification, c(&quot;domain&quot;,&quot;phylum&quot;,&quot;class&quot;,&quot;order&quot;,&quot;family&quot;,&quot;genus&quot;,&quot;species&quot;), sep =&quot;;&quot;) represented_genera &lt;- gtdb_metadata %&gt;% filter(genus %in% genus_host$genus) %&gt;% filter(genome %in% gtdb_tree$tip.label) %&gt;% group_by(genus) %&gt;% slice_sample(n = 1) %&gt;% ungroup() ehi_mags_tree &lt;- keep.tip(gtdb_tree, tip=represented_genera$genome) ehi_mags_tree$tip.label &lt;- represented_genera %&gt;% filter(genome %in% ehi_mags_tree$tip.label) %&gt;% # Keep only rows corresponding to tree tip labels arrange(match(genome, ehi_mags_tree$tip.label)) %&gt;% # Match order of genomes to tree tip labels pull(genus) genus_metadata &lt;- genome_metadata %&gt;% filter(phylum %in% selected_phyla) %&gt;% group_by(genus,phylum) %&gt;% summarise(count=n()) %&gt;% filter(genus %in% ehi_mags_tree$tip.label) phylum_metadata &lt;- genus_metadata %&gt;% group_by(phylum) %&gt;% summarise(node = MRCA(ehi_mags_tree, genus)) %&gt;% arrange(node) %&gt;% filter(node&gt;length(ehi_mags_tree$tip.label)) %&gt;% mutate(group = row_number()) ehi_mags_tree &lt;- groupClade(ehi_mags_tree, phylum_metadata$node) # Replace group numbers to phylum names current_groups &lt;- attributes(ehi_mags_tree)$group group_to_phylum &lt;- setNames(phylum_metadata$phylum, phylum_metadata$group) group_to_phylum &lt;- c(`0` = NA,group_to_phylum) new_groups &lt;- sapply(current_groups, function(g) { if (g %in% phylum_metadata$group) { return(group_to_phylum[g]) # Map numeric group to phylum name } else { return(NA) # Keep other nodes NA } }) %&gt;% unname() attributes(ehi_mags_tree)$group &lt;- new_groups #Plot tree ggtree(ehi_mags_tree, layout=&quot;equal_angle&quot;, aes(color = group)) %&lt;+% genus_metadata + geom_tippoint(aes(size = count, alpha=0.5)) + scale_size_continuous(range = c(1, 10)) + scale_color_manual(values = c(&quot;#c9c9c9&quot;,&quot;#8a8a8a&quot;,&quot;#454545&quot;), na.value = &quot;black&quot;) + theme_void() ## Genus - host heatmap genus_host2 &lt;- genus_host %&gt;% select(-phylum) %&gt;% pivot_wider(names_from = host_species, values_from = genomes) %&gt;% column_to_rownames(var=&quot;genus&quot;) genus_host %&gt;% left_join(host_metadata,by=&quot;host_species&quot;) %&gt;% mutate(genus=factor(genus,levels=ehi_mags_tree$tip.label)) %&gt;% ggplot(aes(x=host_species,y=genus,fill=genomes)) + facet_nested(. ~ host_class, space=&quot;free&quot;,scales=&quot;free&quot;) + geom_tile() + scale_fill_gradient(low = &quot;grey&quot;, high = &quot;#2a94d1&quot;, na.value=&quot;white&quot;) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) read_tsv(&quot;https://raw.githubusercontent.com/earthhologenome/EHI_taxonomy_colour/main/ehi_phylum_colors.tsv&quot;) %&gt;% right_join(genus_host, by=join_by(phylum == phylum)) %&gt;% select(genus,phylum) %&gt;% unique %&gt;% mutate(genus=factor(genus,levels=ehi_mags_tree$tip.label)) %&gt;% mutate(xaxis=NA) %&gt;% ggplot(aes(x=xaxis,y=genus,fill=phylum)) + geom_tile() + scale_fill_manual(values=phylum_colors) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
